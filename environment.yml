name: vcc2025
channels:
  - conda-forge
  - bioconda
  - defaults

dependencies:
  # Python
  - python=3.10  # Lock to 3.10 for best compatibility
  
  # Core scientific stack - CRITICAL: Lock numpy to avoid conflicts
  - numpy>=1.23,<1.27  # Compatible with both scanpy and tables
  - pandas>=2.0.0
  - scipy>=1.10.0

  # Workflow management
  - snakemake>=7.32.0

  # Single-cell analysis - Pin versions for stability
  - scanpy>=1.9.3,<1.10
  - anndata>=0.9.0,<0.11
  
  # Data processing
  - scikit-learn>=1.2.0,<1.4
  
  # Visualization
  - matplotlib=3.8.0
  - seaborn>=0.12.0,<0.14
  
  # File handling - Use older tables to avoid numpy conflict
  - h5py>=3.8.0
  - pytables>=3.8.0,<3.9  # CRITICAL: Avoid 3.9.x which needs numpy>=1.23.5
  
  # Utilities
  - tqdm>=4.65.0
  - pyyaml>=6.0
  - requests>=2.31.0
  
  # Testing
  - pytest>=7.3.0
  
  # Code quality
  - flake8>=6.0.0

  # Windows-compatible
  - leidenalg
  - python-igraph
  
  # pip packages
  - pip>=23.0
  - pip:
    - scrublet>=0.2.3
    - harmonypy>=0.0.9
    - bbknn>=1.5.1
    - gseapy>=1.0.4
    # scvi-tools SKIP on Windows